<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
  <title>Convert form with Data Table into PDF and send for approval &mdash; Plumsail Forms </title>
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/header.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/doc-content.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="/wp-content/themes/plumsail/assets/images/favicon.ico"
  type="image/x-icon">

  
    <title>Convert form with Data Table into PDF and send for approval &mdash; Forms 1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/theme_overrides_guzzle.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Forms 1.0 documentation" href="../index.html" />
    <link rel="up" title="Data Tables and MS Flow" href="data-table-section.html" />
    <link rel="next" title="Format Data Table in an HTML-template before converting into PDF" href="data-table-convert-html.html" />
    <link rel="prev" title="Data Tables and MS Flow" href="data-table-section.html" />
  
   

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="data-table-convert-html.html" title="Format Data Table in an HTML-template before converting into PDF"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="data-table-section.html" title="Data Tables and MS Flow"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Forms 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="data-table-section.html" accesskey="U">Data Tables and MS Flow</a> &raquo;</li> 
      </ul>
    </div>
    <div class="container-wrapper">
            
  <div id="left-column" class="doc-content-sidebar2">
    <div class="sphinxsidebar">
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
        
<div class="sidebar-block">  
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Public Web Forms</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Designing and publishing forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../microsoft-flow.html">Handling data in Microsoft Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zapier.html">Handling data in Zapier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licensing.html">Public Forms Licensing</a></li>
</ul>
<p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/version-history.html">Version history</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UCR7Ni67GwQ228j9MuGq-39A">YouTube Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/data-security.html">Data protection and security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/privacy-policy.html">Forms Privacy Policy</a></li>
</ul>
<p class="caption"><span class="caption-text">Designer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../designer/ribbon-actions.html">Ribbon Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/themes.html">Themes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/controls.html">Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/fields.html">Fields</a></li>
</ul>
<p class="caption"><span class="caption-text">JavaScript framework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../javascript/general.html">JavaScript Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/manager.html">Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/toolbar.html">Toolbar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/controls.html">Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/fields.html">Fields</a></li>
</ul>
<p class="caption"><span class="caption-text">How-to</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="simple-cases-flow.html">Simple Cases with MS Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-forms-js.html">Dynamic Forms with the use of JavaScript</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="data-table-section.html">Data Tables and MS Flow</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Convert form with Data Table into PDF and send for approval</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-table-convert-html.html">Format Data Table in an HTML-template before converting into PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-table-to-sp.html">Creating a web form with Data Table and saving data into SharePoint lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="excel-datatable.html">Use table to add rows to Excel (Office365) or Google Sheet from Public Web Form</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zapier.html">Zapier Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Other</a></li>
</ul>

    
  </div>
</div>
    </div>
  </div>
        
                <div id="right-column">
                    <header class="header">
                        <div class="container">
                            <div class="row">
                                <div class="col-12">
                                    <div class="header__logo">
                                            <a href="/"><img src="/wp-content/themes/plumsail/assets/images/logo.svg" alt=""></a>
                                    </div>
                                    <nav class="header__menu">
                                        <ul class="main-menu">
                                            <li class="main-menu__drop"><a href="#products"><span></span>Products</a></li>
                                            <ul id="menu-main-menu" class="menu"><li id="menu-item-151" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-151"><a target="_blank" href="https://community.plumsail.com">Community</a></li>
                                                <li id="menu-item-20706" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20706"><a href="/store/">Store</a></li>
                                                <li id="menu-item-152" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-152"><a target="_blank" href="https://medium.com/plumsail">Blog</a></li>
                                                <li id="menu-item-20708" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20708"><a href="/partners-and-resellers/">Partners</a></li>
                                                <li id="menu-item-20707" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20707"><a href="/company/">Company</a></li>
                                            </ul>                    
                                        </ul>
                                    </nav>
                                    <div class="burger">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </div>                            
                                    <!-- mobile menu -->
                                    <div class="mobile-menu-bg"></div>
                                    <div class="mobile-menu">
                                        <div class="mobile-menu__body">
                                            <div class="mobile-menu__inner">
                                                <ul class="mobile-menu-list">
                                                    <li class="mobile-menu-list__sub">
                                                        <a href="#">Products</a>
                                                        <ul class="mobile-menu-list-sub">
                                                            <li>
                                                                <a href="/sharepoint-helpdesk/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/help_desk.svg">HelpDesk</a>
                                                            </li>
                                                            <li>
                                                                    <a href="/documents/"><img src="/wp-content/themes/plumsail/assets/images/documents.svg">Documents</a>
                                                            </li>
                                                            <li>
                                                                <a href="/actions/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/actions.svg">Actions</a>
                                                            </li>
                                                            <li>
                                                                <a href="/workflow-actions-pack/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/workflow_action_pack.svg">Workflow
                                                                    Actions Pack</a>
                                                            </li>
                                                            <li>
                                                                <a href="/forms/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/forms.svg">Forms</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-forms-designer/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/forms_designer.svg">Forms
                                                                    Designer</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-dashboard-designer/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/dashboard_designer.svg">Dashboard
                                                                    Designer</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-workflow-scheduler/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/workflow_scheduler.svg">Workflow
                                                                    Scheduler</a>
                                                            </li>
                                                            <li>
                                                                <a href="/cross-site-lookup/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/crosssite_lookup.svg">Cross-site
                                                                    lookup</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-orgchart/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/org_chat.svg">Org
                                                                    Chart</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <ul id="menu-main-menu-1" class="menu">
                                                        <li class=''><a target="_blank" href="https://community.plumsail.com">Community</a></li>
                                                        <li class=''><a href="/store/">Store</a></li>
                                                        <li class=''><a target="_blank" href="https://medium.com/plumsail">Blog</a></li>
                                                        <li class=''><a href="/partners-and-resellers/">Partners</a></li>
                                                        <li class=''><a href="/company/">Company</a></li>
                                                    </ul>                            
                                                </ul>
                                                <ul class="follow-us follow-us--mobile-menu">
                                                    <li class="follow-us__item follow-us--google">
                                                        <a href="https://plus.google.com/b/112093525198664117371/+PlumsailSharePointTeam?hl=ru" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000" d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                    <li class="follow-us__item follow-us--twitter">
                                                        <a href="https://twitter.com/plumsail_sp" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000"
                                                                      d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                    <li class="follow-us__item follow-us--facebook">
                                                        <a href="https://www.facebook.com/Plumsail/?notif_t=page_admin&amp;notif_id=1482313956804883" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000"
                                                                      d="M17,2V2H17V6H15C14.31,6 14,6.81 14,7.5V10H14L17,10V14H14V22H10V14H7V10H10V6A4,4 0 0,1 14,2H17Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                    <li class="follow-us__item follow-us--linkedin">
                                                        <a href="https://www.linkedin.com/company/plumsail?trk=top_nav_home" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000"
                                                                      d="M21,21H17V14.25C17,13.19 15.81,12.31 14.75,12.31C13.69,12.31 13,13.19 13,14.25V21H9V9H13V11C13.66,9.93 15.36,9.24 16.5,9.24C19,9.24 21,11.28 21,13.75V21M7,21H3V9H7V21M5,3A2,2 0 0,1 7,5A2,2 0 0,1 5,7A2,2 0 0,1 3,5A2,2 0 0,1 5,3Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /mobile menu -->
                                </div>
                            </div>
                        </div>
                        </header>
                        <section class="mega-menu">
                            <div class="container">
                                <div class="row">
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--helpdesk">
                                                    <a href="/sharepoint-helpdesk/" class="mega-subcat__title">HelpDesk</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/help-desk-o365/v1.x/">Documentation</a>
                                                        <a href="/sharepoint-helpdesk/store/">Pricing</a>
                                                        <a href="/sharepoint-helpdesk/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Support service
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--documents">
                                                    <a href="/documents/" class="mega-subcat__title">Documents</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/documents/v1.x/">Documentation</a>
                                                        <a href="/documents/store/">Pricing</a>
                                                        <a href="/documents/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--actions">
                                                    <a href="/actions/" class="mega-subcat__title">Actions</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/actions/v1.x/">Documentation</a>
                                                        <a href="/actions/store/">Pricing</a>
                                                        <a href="/actions/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--actionspack">
                                                    <a href="/workflow-actions-pack/" class="mega-subcat__title">Workflow Actions
                                                        Pack</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/workflow-actions-pack/">Documentation</a>
                                                        <a href="/workflow-actions-pack/store/">Pricing</a>
                                                        <a href="/workflow-actions-pack/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--scheduler">
                                                    <a href="/sharepoint-workflow-scheduler/" class="mega-subcat__title">Workflow
                                                        Scheduler</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/sharepoint-workflow-scheduler/docs/">Documentation</a>
                                                        <a href="/workflow-actions-pack/store/">Pricing</a>
                                                        <a href="/sharepoint-workflow-scheduler/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Workflows
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--forms">
                                                    <a href="/forms/" class="mega-subcat__title">Forms</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/forms/">Documentation</a>
                                                        <a href="/forms/store/">Pricing</a>
                                                        <a href="/forms/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--formsdesigner">
                                                    <a href="/sharepoint-forms-designer/" class="mega-subcat__title">Forms Designer</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="https://spform.com/documentation" target="_blank">Documentation</a>
                                                        <a href="https://spform.com/buy" target="_blank">Pricing</a>
                                                        <a href="/sharepoint-forms-designer/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--crosssite">
                                                    <a href="/cross-site-lookup/" class="mega-subcat__title">Cross-site lookup</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="https://spform.com/documentation" target="_blank">Documentation</a>
                                                        <a href="https://spform.com/buy" target="_blank">Pricing</a>
                                                        <a href="/cross-site-lookup/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Forms
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--dashboard">
                                                    <a href="/sharepoint-dashboard-designer/" class="mega-subcat__title">Dashboard
                                                        Designer</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/sharepoint-dashboard-designer/documentation/">Documentation</a>
                                                        <a href="/sharepoint-dashboard-designer/store/">Pricing</a>
                                                        <a href="/sharepoint-dashboard-designer/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--org">
                                                    <a href="/sharepoint-orgchart/" class="mega-subcat__title">Org Chart</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/sharepoint-orgchart/docs/">Documentation</a>
                                                        <a href="/sharepoint-orgchart/store/">Pricing</a>
                                                        <a href="/sharepoint-orgchart/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Visualization
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>                        
                    
                        <section class="breadcrumb">
                            <div class="row">
                                <div class="col-12"  style="padding-left:10px;">
                                    <a href="/forms/">Forms</a>
                                    <span>›</span>
                                    <a href="../index.html">Documentation</a>
                                    <span>›</span>
                                    
                                    <a href="data-table-section.html">Data Tables and MS Flow</a>
                                    
                                    Convert form with Data Table into PDF and send for approval
                                </div>
                            </div>
                        </section>
                    
                    <div class="document clearer container doc-content2">
                        
  <div class="section" id="convert-form-with-data-table-into-pdf-and-send-for-approval">
<h1>Convert form with Data Table into PDF and send for approval<a class="headerlink" href="#convert-form-with-data-table-into-pdf-and-send-for-approval" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#description" id="id1">Description</a></li>
<li><a class="reference internal" href="#design-a-form" id="id2">Design a form</a></li>
<li><a class="reference internal" href="#form-s-logic" id="id3">Form's Logic</a></li>
<li><a class="reference internal" href="#microsoft-flow-using-html-table" id="id4">Microsoft Flow using HTML Table</a></li>
<li><a class="reference internal" href="#plumsail-actions-in-ms-flow-for-datatable" id="id5">Plumsail Actions in MS Flow for DataTable</a></li>
<li><a class="reference internal" href="#send-an-email-with-pdf-attachment" id="id6">Send an email with PDF attachment</a></li>
<li><a class="reference internal" href="#summary" id="id7">Summary</a></li>
</ul>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id1">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>With recently added <a class="reference internal" href="../designer/controls.html#designer-datatable"><span class="std std-ref">DataTable</span></a> control, we can design a more complex form and then submit it to Flow.</p>
<p>In this example, we will design an Expense Reimbursement Form, which will include DataTable to list all the expenses,
as well as Ink Sketch controls to get signatures from the user and his supervisor.</p>
</div>
<div class="section" id="design-a-form">
<h2><a class="toc-backref" href="#id2">Design a form</a><a class="headerlink" href="#design-a-form" title="Permalink to this headline">¶</a></h2>
<p>First, we will design a form, which will include all the necessary information from the employee, such as name, ID, Department, and the purpose behind the expenses.
We will also include two date fields From and To, which will include time period during which the expenses took place.</p>
<p>Next, our form will have DataTable to store all the expenses and will include Description, Category and Cost.</p>
<p>After the table, we will have Total field which will automatically calculate and display Total amount of expenses.</p>
<p>Finally, the form will include a signature pad for the employee to sign the form.</p>
<p>Here's our result:</p>
<img alt="Expense Reimbursement Form" src="../_images/1_Form.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>With this form we can compose a PDF file and send it for the approval.</p>
<p>But first, let's work on our form's logic to make sure that all fields are set correctly on our form.</p>
</div>
<div class="section" id="form-s-logic">
<span id="data-table-form"></span><h2><a class="toc-backref" href="#id3">Form's Logic</a><a class="headerlink" href="#form-s-logic" title="Permalink to this headline">¶</a></h2>
<p>So, what JavaScript logic do we need? First, we need to make sure that all fields are set correctly and that the form is signed.</p>
<p>First we set all fields as mandatory, as none of them are optional. This can be done in the designer by selecting a field and changing SETTINGS  → Required to True:</p>
<img alt="Name field is set as Required" src="../_images/1_Field_Required.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>We can also do the same with DataTable columns by selecting the column and also changing SETTINGS  →  Required to True:</p>
<img alt="Description column is set as Required" src="../_images/1_Column_Required.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now that the fields and columns are set as required, we can work on Form validators to make sure that the form is signed and that the fields have correct input.</p>
<p>Let's make sure that the Date &quot;To&quot; is greater or the same as Date &quot;From&quot;:</p>
<img alt="Date &quot;To&quot; must be greater or the same as Date &quot;From&quot;" src="../_images/1_Date_Error.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>We can also have another validator to make sure that the form is signed:</p>
<img alt="Form needs to be signed before submission" src="../_images/1_Signature_Error.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now, let's add both these validators to our form with this code:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">//once the form is rendered:</span>
<span class="nx">fd</span><span class="p">.</span><span class="nx">rendered</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="nx">fd</span><span class="p">.</span><span class="nx">validators</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;DateValidator&#39;</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;&quot;To&quot; must be greater or the same as &quot;From&quot;&#39;</span><span class="p">,</span>
        <span class="nx">validate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">fd</span><span class="p">.</span><span class="nx">field</span><span class="p">(</span><span class="s1">&#39;From&#39;</span><span class="p">).</span><span class="nx">value</span> <span class="o">&gt;=</span> <span class="nx">fd</span><span class="p">.</span><span class="nx">field</span><span class="p">(</span><span class="s1">&#39;To&#39;</span><span class="p">).</span><span class="nx">value</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>

            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;SignatureValidator&#39;</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;Please, sign the form before submitting&#39;</span><span class="p">,</span>
        <span class="nx">validate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">fd</span><span class="p">.</span><span class="nx">control</span><span class="p">(</span><span class="s1">&#39;Signature&#39;</span><span class="p">).</span><span class="nx">value</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>

            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Final piece of code that we need to implement is an automatic calculation of Total field.</p>
<p>Each time a user changes values in Cost column of Expenses DataTable, Total needs to be recalculated.</p>
<p>The field itself will be set to disabled state, so the user won't be able to change it directly, only by adding Cost to the records in Expenses DataTable:</p>
<img alt="Expenses calculated automatically from the table records" src="../_images/1_Expenses_Calculation.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This can be done with JavaScript, which will add inside fd.rendered() event function after adding our validators:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">fd</span><span class="p">.</span><span class="nx">rendered</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
    <span class="c1">//... validators are added here</span>

    <span class="nx">fd</span><span class="p">.</span><span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Total&quot;</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="nx">fd</span><span class="p">.</span><span class="nx">control</span><span class="p">(</span><span class="s1">&#39;ExpensesTable&#39;</span><span class="p">).</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                <span class="nx">total</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Cost</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">// Total field is a Text field, so I can add a dollar symbol to it:</span>
        <span class="nx">fd</span><span class="p">.</span><span class="nx">field</span><span class="p">(</span><span class="s2">&quot;Total&quot;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="nx">total</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Now that we are done with Form configuration, it's time to set up our Flow.</p>
</div>
<div class="section" id="microsoft-flow-using-html-table">
<h2><a class="toc-backref" href="#id4">Microsoft Flow using HTML Table</a><a class="headerlink" href="#microsoft-flow-using-html-table" title="Permalink to this headline">¶</a></h2>
<p>In this example we will first create HTML Template from the submitted data and then transform HTML into PDF and send it via Email.</p>
<p>We will use <a href="https://plumsail.com/actions/" target="_blank">Plumsail Actions</a> to create HTML with template which would use submitted data, then convert this HTML into PDF.</p>
<p>If you haven't read our introduction to using MS Flow with Plumsail Forms, you can find information on how to add our custom connector <a class="reference internal" href="../microsoft-flow.html"><span class="doc">here</span></a>.</p>
<p>You can also find information about how to subscribe to Form submission in the <a class="reference internal" href="../microsoft-flow.html#creating-flow"><span class="std std-ref">Creating Flow</span></a> section.</p>
<p>Once you set up the basics of the Flow for our Form, including Form submission trigger and JSON Parse action, we can start working on our HTML.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>First, let's convert our DataTable into HTML Table. Search for HTML Table and select <em>Data Operations - Create HTML table</em> action:</p>
<img alt="Search for HTML Table and select Data Operations - Create HTML table" src="../_images/2_HTML_Table_Search.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Here, we pass ExpensesTable in From field, I also open Advanced options and select <em>Include headers</em> - Yes:</p>
<img alt="HTML Table set up" src="../_images/3_HTML_Table.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="plumsail-actions-in-ms-flow-for-datatable">
<span id="plumsail-actions-flow"></span><h2><a class="toc-backref" href="#id5">Plumsail Actions in MS Flow for DataTable</a><a class="headerlink" href="#plumsail-actions-in-ms-flow-for-datatable" title="Permalink to this headline">¶</a></h2>
<p>Now, we will use Plumsail Actions connector, which you can read about setting up <a href="https://plumsail.com/docs/actions/v1.x/getting-started/use-from-flow.html" target="_blank">here</a>.</p>
<p>You can either create Custom connector or use MS Flow Premium connector,
but you will need to have an API key from <a href="https://auth.plumsail.com/account/login" target="_blank">Plumsail Account</a> in both cases.</p>
<p>Once the connector is set up, search for HTML Template and select <em>Plumsail Documents - Create HTML from template</em>:</p>
<img alt="Search for HTML Template and select Plumsail Documents - Create HTML from template" src="../_images/4_Plumsail_Documents_Search.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Once the action is added, we need to fill in both <em>Source HTML</em> and <em>Template Data</em>.
Since <em>Source HTML</em> uses <em>Template Data</em> quite extensively, it's best to first define <em>Template Data</em>.</p>
<p><em>Template Data</em> needs to be composed as a JavaScript object where we include all our data - original form output, our HTML table.</p>
<p><em>Template Data</em> is also the place where we will format our dates to look more appealing in the end result.</p>
<p>First, I'll create the basic structure for our object:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;Form&quot;</span><span class="o">:</span> <span class="nx">INSERT</span> <span class="nx">FORM</span> <span class="nx">HERE</span><span class="p">,</span>
    <span class="s2">&quot;Table&quot;</span><span class="o">:</span> <span class="nx">INSERT</span> <span class="nx">HTML</span> <span class="nx">TABLE</span> <span class="nx">HERE</span><span class="p">,</span>
    <span class="s2">&quot;From&quot;</span><span class="o">:</span> <span class="nx">CONVERT</span> <span class="nx">DATE</span> <span class="nx">HERE</span><span class="p">,</span>
    <span class="s2">&quot;To&quot;</span><span class="o">:</span> <span class="nx">CONVERT</span> <span class="nx">SECOND</span> <span class="nx">DATE</span> <span class="nx">HERE</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now, we can insert Form Body inside &quot;Form&quot; and result of HTML Table conversion inside &quot;Table&quot;:</p>
<img alt="HTML Template data with Form and Table" src="../_images/5_HTML_TemplateData.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Next, we need to convert Dates. If you go to Expression, you can select <strong>formatDateTime()</strong> function
then go back to Dynamic Content and insert one of date fields as first parameter in formatDateTime(<strong>Date Here</strong>, ...):</p>
<img alt="Format date" src="../_images/5_HTML_Template_FormatDate.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Then add format as the second parameter so it looks like this and click OK:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">formatDateTime</span><span class="p">(</span><span class="nx">body</span><span class="p">(</span><span class="s1">&#39;Parse_JSON&#39;</span><span class="p">)</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">],</span> <span class="s1">&#39;MM/dd/yyyy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This is our final version of Template Data:</p>
<img alt="HTML Template data final with dates" src="../_images/3_HTML_Template_DataFinal.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now we can write Source HTML and use our Template data to populate it. We can also include style with it by either linking HTML to CSS file or just include style tag inside Source HTML.</p>
<p>Here's an HTML that I've used:</p>
<div class="highlight-HTML"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Expense Reimbursement Request<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="nt">body</span> <span class="p">{</span><span class="k">font-family</span><span class="p">:</span><span class="n">Arial</span><span class="p">,</span> <span class="n">Helvetica</span><span class="p">,</span> <span class="kc">sans-serif</span><span class="p">;}</span>
        <span class="nt">table</span> <span class="p">{</span><span class="k">border-collapse</span><span class="p">:</span> <span class="kc">collapse</span><span class="p">;</span> <span class="k">width</span><span class="p">:</span> <span class="mi">60</span><span class="kt">%</span><span class="p">;</span> <span class="p">}</span>
        <span class="nt">table</span><span class="o">,</span> <span class="nt">th</span><span class="o">,</span> <span class="nt">td</span> <span class="p">{</span><span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="kc">slategray</span><span class="p">;</span> <span class="k">margin</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;}</span>
        <span class="p">.</span><span class="nc">signature</span> <span class="p">{</span> <span class="k">display</span><span class="p">:</span> <span class="kc">inline</span><span class="p">;</span> <span class="k">width</span><span class="p">:</span> <span class="mi">30</span><span class="kt">%</span> <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Expense Reimbursement Request<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Name: {{Form.Name}}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Department: {{Form.Department}}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Business Purpose: {{Form.Purpose}}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>From: {{From}} To: {{To}} <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Table of expenses:<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
    {{Table}}
    <span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Total: {{Form.Total}}<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;signature&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h4</span><span class="p">&gt;</span>Signature:<span class="p">&lt;/</span><span class="nt">h4</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{Form.Signature}}&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Last thing that we need to do is convert HTML into PDF. Search for Plumsail Documents and select <em>Plumsail Documents - Convert HTML to PDF</em>:</p>
<img alt="Search for Plumsail Documents and select Plumsail Documents - Convert HTML to PDF" src="../_images/6_Plumsail_Documents_Search2.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now we place Result HTML from the last action inside Source HTML field:</p>
<img alt="Plumsail Documents - Convert HTML to PDF" src="../_images/7_Plumsail_Convert_HTML_to_PDF.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="send-an-email-with-pdf-attachment">
<span id="email-pdf-attachment"></span><h2><a class="toc-backref" href="#id6">Send an email with PDF attachment</a><a class="headerlink" href="#send-an-email-with-pdf-attachment" title="Permalink to this headline">¶</a></h2>
<p>We'll use Microsoft's <em>Office 365 Outlook - Send an email</em> action to send an email. Select it:</p>
<img alt="Send an email" src="../_images/10_SendAnEmail.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Fill in the information for the email, then open Advanced options and add result PDF as an attachment:</p>
<img alt="Add an attachment" src="../_images/8_Send_Email.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now, when we run the Flow, I receive an email with this PDF:</p>
<img alt="Final PDF" src="../_images/9_Final_PDF.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id7">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In conclusion, I just wanted to bring your attention on how easy it is to transform any Plumsail Form submitted to Flow into PDF with <a href="https://plumsail.com/actions/" target="_blank">Plumsail Actions</a>.</p>
<p>Just follow three easy steps - submit form to Flow and parse JSON, transform data to HTML template and transform HTML template to PDF.</p>
<p>You can read more about the first step in our <a class="reference internal" href="../microsoft-flow.html#creating-flow"><span class="std std-ref">Creating Flow</span></a> article.</p>
<p>Trasnforming to HTML is also an easy step with Plumsail Actions, read more about it here - <a href="https://plumsail.com/docs/actions/v1.x/flow/how-tos/documents/create-html-from-template.html" target="_blank">Create HTML document from template</a>.</p>
<p>You can even include any custom layout in HTML template, for example, your company's logo in the header of template and extra information in the footer:</p>
<img alt="PDF result from HTML" src="../_images/10_html-and-pdf-result.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Finally, transforming to PDF couldn't be easier and just done in one easy step, where you take output HTML and transform it directly to PDF.</p>
<p>It's described fully in <a href="https://plumsail.com/docs/actions/v1.x/flow/how-tos/documents/create-pdf-from-html-template.html" target="_blank">Create PDF from HTML template</a> article.</p>
</div>
</div>


                    </div>
                    <div class="clearfix" style="padding-bottom: 50px;"></div>
                </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="data-table-convert-html.html" title="Format Data Table in an HTML-template before converting into PDF"
             >next</a> |</li>
        <li class="right" >
          <a href="data-table-section.html" title="Data Tables and MS Flow"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Forms 1.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="data-table-section.html" >Data Tables and MS Flow</a> &raquo;</li> 
      </ul>
    </div>
    <script type="text/javascript">
      $("#mobile-toggle a").click(function () {
        $("#left-column").toggle();
      });
    </script>
    <script type="text/javascript" src="../_static/js/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/js/main.min.js"></script>
        <footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <nav class="footer__menu">
          <ul id="menu-footer-menu" class="menu"><li class=""><a href="#products">Products</a></li>
            <li class=""><a target="_blank" href="https://community.plumsail.com">Community</a></li>
            <li class=""><a href="/store/">Store</a></li>
            <li class=""><a target="_blank" href="https://medium.com/plumsail">Blog</a></li>
            <li class=""><a href="/partners-and-resellers/">Partners</a></li>
            <li class=""><a href="/company/">Company</a></li>
          </ul>
        </nav>
        <div class="footer__copyright">
          © 2011 - 2018 Plumsail. All rights reserved | <a href="/privacy-policy/">Privacy Policy</a> | <a href="/refund-policy/">Refund policy</a>
        </div>
      </div>
    </div>
  </div>
</footer>
            <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36215023-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>