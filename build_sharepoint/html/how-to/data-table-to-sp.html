
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <title>Creating a web form with Data Table and saving data into SharePoint lists &mdash; Plumsail Forms </title>
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/header.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/doc-content.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="/wp-content/themes/plumsail/assets/images/favicon.ico"
  type="image/x-icon">

  
    <title>Creating a web form with Data Table and saving data into SharePoint lists &#8212; Forms 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/theme_overrides_guzzle.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Use table to add rows to Excel (Office365) or Google Sheet from Public Web Form" href="excel-datatable.html" />
    <link rel="prev" title="Format Data Table in an HTML-template before converting into PDF" href="data-table-convert-html.html" />
  
   

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="excel-datatable.html" title="Use table to add rows to Excel (Office365) or Google Sheet from Public Web Form"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="data-table-convert-html.html" title="Format Data Table in an HTML-template before converting into PDF"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Forms 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="data-table-section.html" accesskey="U">Data Tables and MS Flow</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">
            
  <div id="left-column" class="doc-content-sidebar2">
    <div class="sphinxsidebar">
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
        
<div class="sidebar-block">  
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Table of contents</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../start-public.html">Public Web Forms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start-sp.html">SharePoint Forms for Modern UI</a></li>
</ul>
<p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/version-history.html">Version history</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.youtube.com/channel/UCR7Ni67GwQ228j9MuGq-39A">YouTube Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/data-security.html">Data protection and security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/privacy-policy.html">Forms Privacy Policy</a></li>
</ul>
<p class="caption"><span class="caption-text">Designer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../designer/ribbon-actions.html">Ribbon Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/form-sets.html">Form Sets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/themes.html">Themes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/controls.html">Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/fields.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/fields-sp.html">SharePoint Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/provision.html">SharePoint Forms Provision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../designer/panel.html">SharePoint Form Panel</a></li>
</ul>
<p class="caption"><span class="caption-text">JavaScript framework</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../javascript/general.html">JavaScript Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/manager.html">Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/toolbar.html">Toolbar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/containers.html">Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/controls.html">Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/fields.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/fields-sp.html">SharePoint Fields</a></li>
</ul>
<p class="caption"><span class="caption-text">How-to</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="simple-cases-flow.html">Simple Cases with MS Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="power-apps.html">PowerApps Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-forms-js.html">Dynamic Forms with the use of JavaScript</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="data-table-section.html">Data Tables and MS Flow</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data-table-flow.html">Convert form with Data Table into PDF and send for approval</a></li>
<li class="toctree-l2"><a class="reference internal" href="data-table-convert-html.html">Format Data Table in an HTML-template before converting into PDF</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Creating a web form with Data Table and saving data into SharePoint lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="excel-datatable.html">Use table to add rows to Excel (Office365) or Google Sheet from Public Web Form</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="list-or-library-section.html">List or Library configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="lookup-section.html">Advanced lookup settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="zapier.html">Zapier Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Other</a></li>
</ul>

    
  </div>
</div>
    </div>
  </div>
        
                <div id="right-column">
                    <header class="header">
                        <div class="container">
                            <div class="row">
                                <div class="col-12">
                                    <div class="header__logo">
                                            <a href="/"><img src="/wp-content/themes/plumsail/assets/images/logo.svg" alt=""></a>
                                    </div>
                                    <nav class="header__menu">
                                        <ul class="main-menu">
                                            <li class="main-menu__drop"><a href="#products"><span></span>Products</a></li>
                                            <ul id="menu-main-menu" class="menu"><li id="menu-item-151" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-151"><a target="_blank" href="https://community.plumsail.com">Community</a></li>
                                                <li id="menu-item-20706" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20706"><a href="/store/">Store</a></li>
                                                <li id="menu-item-152" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-152"><a target="_blank" href="https://medium.com/plumsail">Blog</a></li>
                                                <li id="menu-item-20708" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20708"><a href="/partners-and-resellers/">Partners</a></li>
                                                <li id="menu-item-20707" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20707"><a href="/company/">Company</a></li>
                                            </ul>                    
                                        </ul>
                                    </nav>
                                    <div class="burger">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </div>                            
                                    <!-- mobile menu -->
                                    <div class="mobile-menu-bg"></div>
                                    <div class="mobile-menu">
                                        <div class="mobile-menu__body">
                                            <div class="mobile-menu__inner">
                                                <ul class="mobile-menu-list">
                                                    <li class="mobile-menu-list__sub">
                                                        <a href="#">Products</a>
                                                        <ul class="mobile-menu-list-sub">
                                                            <li>
                                                                <a href="/sharepoint-helpdesk/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/help_desk.svg">HelpDesk</a>
                                                            </li>
                                                            <li>
                                                                    <a href="/documents/"><img src="/wp-content/themes/plumsail/assets/images/documents.svg">Documents</a>
                                                            </li>
                                                            <li>
                                                                <a href="/actions/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/actions.svg">Actions</a>
                                                            </li>
                                                            <li>
                                                                <a href="/workflow-actions-pack/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/workflow_action_pack.svg">Workflow
                                                                    Actions Pack</a>
                                                            </li>
                                                            <li>
                                                                <a href="/forms/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/forms.svg">Forms</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-forms-designer/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/forms_designer.svg">Forms
                                                                    Designer</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-dashboard-designer/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/dashboard_designer.svg">Dashboard
                                                                    Designer</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-workflow-scheduler/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/workflow_scheduler.svg">Workflow
                                                                    Scheduler</a>
                                                            </li>
                                                            <li>
                                                                <a href="/cross-site-lookup/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/crosssite_lookup.svg">Cross-site
                                                                    lookup</a>
                                                            </li>
                                                            <li>
                                                                <a href="/sharepoint-orgchart/"><img
                                                                            src="/wp-content/themes/plumsail/assets/images/org_chat.svg">Org
                                                                    Chart</a>
                                                            </li>
                                                        </ul>
                                                    </li>
                                                    <ul id="menu-main-menu-1" class="menu">
                                                        <li class=''><a target="_blank" href="https://community.plumsail.com">Community</a></li>
                                                        <li class=''><a href="/store/">Store</a></li>
                                                        <li class=''><a target="_blank" href="https://medium.com/plumsail">Blog</a></li>
                                                        <li class=''><a href="/partners-and-resellers/">Partners</a></li>
                                                        <li class=''><a href="/company/">Company</a></li>
                                                    </ul>                            
                                                </ul>
                                                <ul class="follow-us follow-us--mobile-menu">
                                                    <li class="follow-us__item follow-us--google">
                                                        <a href="https://plus.google.com/b/112093525198664117371/+PlumsailSharePointTeam?hl=ru" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000" d="M23,11H21V9H19V11H17V13H19V15H21V13H23M8,11V13.4H12C11.8,14.4 10.8,16.4 8,16.4C5.6,16.4 3.7,14.4 3.7,12C3.7,9.6 5.6,7.6 8,7.6C9.4,7.6 10.3,8.2 10.8,8.7L12.7,6.9C11.5,5.7 9.9,5 8,5C4.1,5 1,8.1 1,12C1,15.9 4.1,19 8,19C12,19 14.7,16.2 14.7,12.2C14.7,11.7 14.7,11.4 14.6,11H8Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                    <li class="follow-us__item follow-us--twitter">
                                                        <a href="https://twitter.com/plumsail_sp" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000"
                                                                      d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                    <li class="follow-us__item follow-us--facebook">
                                                        <a href="https://www.facebook.com/Plumsail/?notif_t=page_admin&amp;notif_id=1482313956804883" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000"
                                                                      d="M17,2V2H17V6H15C14.31,6 14,6.81 14,7.5V10H14L17,10V14H14V22H10V14H7V10H10V6A4,4 0 0,1 14,2H17Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                    <li class="follow-us__item follow-us--linkedin">
                                                        <a href="https://www.linkedin.com/company/plumsail?trk=top_nav_home" target="_blank">
                                                            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                                                                <path fill="#000000"
                                                                      d="M21,21H17V14.25C17,13.19 15.81,12.31 14.75,12.31C13.69,12.31 13,13.19 13,14.25V21H9V9H13V11C13.66,9.93 15.36,9.24 16.5,9.24C19,9.24 21,11.28 21,13.75V21M7,21H3V9H7V21M5,3A2,2 0 0,1 7,5A2,2 0 0,1 5,7A2,2 0 0,1 3,5A2,2 0 0,1 5,3Z"/>
                                                            </svg>
                                                        </a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- /mobile menu -->
                                </div>
                            </div>
                        </div>
                        </header>
                        <section class="mega-menu">
                            <div class="container">
                                <div class="row">
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--helpdesk">
                                                    <a href="/sharepoint-helpdesk/" class="mega-subcat__title">HelpDesk</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/help-desk-o365/v1.x/">Documentation</a>
                                                        <a href="/sharepoint-helpdesk/store/">Pricing</a>
                                                        <a href="/sharepoint-helpdesk/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Support service
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--documents">
                                                    <a href="/documents/" class="mega-subcat__title">Documents</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/documents/v1.x/">Documentation</a>
                                                        <a href="/documents/store/">Pricing</a>
                                                        <a href="/documents/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--actions">
                                                    <a href="/actions/" class="mega-subcat__title">Actions</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/actions/v1.x/">Documentation</a>
                                                        <a href="/actions/store/">Pricing</a>
                                                        <a href="/actions/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--actionspack">
                                                    <a href="/workflow-actions-pack/" class="mega-subcat__title">Workflow Actions
                                                        Pack</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/workflow-actions-pack/">Documentation</a>
                                                        <a href="/workflow-actions-pack/store/">Pricing</a>
                                                        <a href="/workflow-actions-pack/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--scheduler">
                                                    <a href="/sharepoint-workflow-scheduler/" class="mega-subcat__title">Workflow
                                                        Scheduler</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/sharepoint-workflow-scheduler/docs/">Documentation</a>
                                                        <a href="/workflow-actions-pack/store/">Pricing</a>
                                                        <a href="/sharepoint-workflow-scheduler/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Workflows
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--forms">
                                                    <a href="/forms/" class="mega-subcat__title">Forms</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/docs/forms/">Documentation</a>
                                                        <a href="/forms/store/">Pricing</a>
                                                        <a href="/forms/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--formsdesigner">
                                                    <a href="/sharepoint-forms-designer/" class="mega-subcat__title">Forms Designer</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="https://spform.com/documentation" target="_blank">Documentation</a>
                                                        <a href="https://spform.com/buy" target="_blank">Pricing</a>
                                                        <a href="/sharepoint-forms-designer/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--crosssite">
                                                    <a href="/cross-site-lookup/" class="mega-subcat__title">Cross-site lookup</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="https://spform.com/documentation" target="_blank">Documentation</a>
                                                        <a href="https://spform.com/buy" target="_blank">Pricing</a>
                                                        <a href="/cross-site-lookup/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Forms
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="mega-menu__cat">
                                            <div class="mega-menu__cat-cont">
                                                <div class="mega-subcat mega-subcat--dashboard">
                                                    <a href="/sharepoint-dashboard-designer/" class="mega-subcat__title">Dashboard
                                                        Designer</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/sharepoint-dashboard-designer/documentation/">Documentation</a>
                                                        <a href="/sharepoint-dashboard-designer/store/">Pricing</a>
                                                        <a href="/sharepoint-dashboard-designer/support/">Support</a>
                                                    </div>
                                                </div>
                                                <div class="mega-subcat mega-subcat--org">
                                                    <a href="/sharepoint-orgchart/" class="mega-subcat__title">Org Chart</a>
                                                    <div class="mega-subcat__links">
                                                        <a href="/sharepoint-orgchart/docs/">Documentation</a>
                                                        <a href="/sharepoint-orgchart/store/">Pricing</a>
                                                        <a href="/sharepoint-orgchart/support/">Support</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="mega-menu__cat-title">
                                                Visualization
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>                        
                    
                        <section class="breadcrumb">
                            <div class="row">
                                <div class="col-12"  style="padding-left:10px;">
                                    <a href="/forms/">Forms</a>
                                    <span>›</span>
                                    <a href="../index.html">Documentation</a>
                                    <span>›</span>
                                    
                                    <a href="data-table-section.html">Data Tables and MS Flow</a>
                                    
                                    Creating a web form with Data Table and saving data into SharePoint lists
                                </div>
                            </div>
                        </section>
                    
                    <div class="document clearer container doc-content2">
                        
  <div class="section" id="creating-a-web-form-with-data-table-and-saving-data-into-sharepoint-lists">
<h1>Creating a web form with Data Table and saving data into SharePoint lists<a class="headerlink" href="#creating-a-web-form-with-data-table-and-saving-data-into-sharepoint-lists" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#description" id="id1">Description</a></li>
<li><a class="reference internal" href="#form-and-form-s-logic" id="id2">Form and Form’s Logic</a></li>
<li><a class="reference internal" href="#sharepoint-lists" id="id3">SharePoint Lists</a></li>
<li><a class="reference internal" href="#ms-flow" id="id4">MS Flow</a></li>
<li><a class="reference internal" href="#result" id="id5">Result</a></li>
</ul>
</div>
<div class="section" id="description">
<h2><a class="toc-backref" href="#id1">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>We’ve discussed how a form with DataTable can be <a class="reference internal" href="data-table-convert-html.html"><span class="doc">converted into PDF and sent via email</span></a>,
now we’ll use DataTable to add items to SharePoint.</p>
<p>We’ll create an Office Supplies Request form which when submitted will create items in two SharePoint lists - Orders and Ordered Items.
As you might’ve guessed, general information from the form will go into orders
while specific information about each record in DataTable will create an item in Ordered Items list. Ordered Items will have a lookup to tie them to the Order.</p>
</div>
<div class="section" id="form-and-form-s-logic">
<h2><a class="toc-backref" href="#id2">Form and Form’s Logic</a><a class="headerlink" href="#form-and-form-s-logic" title="Permalink to this headline">¶</a></h2>
<p>The Form will be fairly straightforward - we need the department of the company, location to be delivered to, who’ve made the request,
date all items have to be delivered, and finally the table itself.</p>
<p>I will also include Order Total field to calculate total value of the order and here’s our form:</p>
<img alt="Form inside the designer" src="../_images/1_Designer.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now is the harder part, adding JavaScript calculations to the Form. I have two fields that need to be calculated - Order Total and Total for each row.
This calculation needs to happen every time there is a change to the DataTable, so we can use <strong>change</strong> event.</p>
<p>What we’ll do is, we’ll create a variable to store the Order Total, then we’ll go through each row and calculate Total for it and add this Total to Order Total.
Finally, we’ll update Table value with all the Totals calculated and we’ll set Order Total field value to Order Total.</p>
<p>Order Total will be disabled, and Total value will be not be editable either. That’s in order to prevent users from changing these fields manually.</p>
<p>Here’s the code:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="c1">//once the form is rendered</span>
<span class="nx">fd</span><span class="p">.</span><span class="nx">rendered</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//Disable Order Total field</span>
    <span class="nx">fd</span><span class="p">.</span><span class="nx">field</span><span class="p">(</span><span class="s1">&#39;OrderTotal&#39;</span><span class="p">).</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="c1">//Make Total column noneditable</span>
    <span class="nx">fd</span><span class="p">.</span><span class="nx">control</span><span class="p">(</span><span class="s1">&#39;RequestedItemsTable&#39;</span><span class="p">).</span><span class="nx">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">editable</span> <span class="o">=</span>
        <span class="kd">function</span><span class="p">(){</span><span class="k">return</span> <span class="kc">false</span><span class="p">};</span>

    <span class="nx">fd</span><span class="p">.</span><span class="nx">control</span><span class="p">(</span><span class="s1">&#39;RequestedItemsTable&#39;</span><span class="p">).</span><span class="nx">$on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">//variable to count Order Total</span>
        <span class="kd">var</span> <span class="nx">orderTotal</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="c1">//if there are records in the table</span>
        <span class="kd">var</span> <span class="nx">isTableModified</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">){</span>
            <span class="c1">//go through each one by one</span>
            <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">value</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
                <span class="c1">//if this record has Amount and Price</span>
                <span class="k">if</span><span class="p">(</span><span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Amount</span> <span class="o">&amp;&amp;</span> <span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Price</span><span class="p">){</span>
                    <span class="c1">//set Total to their product</span>
                    <span class="kd">var</span> <span class="nx">cost</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Amount</span> <span class="o">*</span> <span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Price</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Total</span> <span class="o">!=</span> <span class="nx">cost</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Total</span> <span class="o">=</span> <span class="nx">cost</span><span class="p">;</span>
                        <span class="nx">isTableModified</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="c1">//add Total to the Order Total</span>
                <span class="nx">orderTotal</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">value</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">Total</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//here we make our change to the table</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">isTableModified</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">fd</span><span class="p">.</span><span class="nx">control</span><span class="p">(</span><span class="s1">&#39;RequestedItemsTable&#39;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">//we set Order Total field to sum of Totals</span>
        <span class="nx">fd</span><span class="p">.</span><span class="nx">field</span><span class="p">(</span><span class="s1">&#39;OrderTotal&#39;</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">orderTotal</span><span class="p">;</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>We can also add some other rules and validators to our form, but for this example it should be enough. Next, we need to create and configure SharePoint Lists to store this data.</p>
</div>
<div class="section" id="sharepoint-lists">
<h2><a class="toc-backref" href="#id3">SharePoint Lists</a><a class="headerlink" href="#sharepoint-lists" title="Permalink to this headline">¶</a></h2>
<p>We need two SharePoint Lists - Orders and Ordered Items.</p>
<p>Orders should have Title, Department, Destination, Requester, Date Needed, and Order Total columns:</p>
<img alt="Orders" src="../_images/2_Orders.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Order Items List on the other hand has to have Title, Amount, Price, Total, Destination and Order columns:</p>
<img alt="Order Items" src="../_images/3_Order_Items.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Now, that the form and lists are ready, it is time to create custom Flow and let it populate lists with data.</p>
</div>
<div class="section" id="ms-flow">
<h2><a class="toc-backref" href="#id4">MS Flow</a><a class="headerlink" href="#ms-flow" title="Permalink to this headline">¶</a></h2>
<p>We will use Flow to first create an Order and then add each record as an item to Order Items.</p>
<p>If you haven’t read our introduction to using MS Flow with Plumsail Forms, you can find information on how to add our custom connector <a class="reference internal" href="../microsoft-flow.html"><span class="doc">here</span></a>.</p>
<p>You can also find information about how to subscribe to Form submission in the <a class="reference internal" href="../microsoft-flow.html#creating-flow"><span class="std std-ref">Creating Flow</span></a> section.</p>
<p>Once you’ve subscribed and parsed JSON from the Form, click <strong>Add an action</strong> and search for <em>SharePoint</em>.
We’ll need to add <em>SharePoint - Create Item</em>, select our Orders list and fill in all the columns with Form fields, like this:</p>
<img alt="Create Order" src="../_images/4_Create_Order.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>To make Title unique I’ve added Date Needed to it, with formatting:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">formatDateTime</span><span class="p">(</span><span class="nx">body</span><span class="p">(</span><span class="s1">&#39;Parse_JSON&#39;</span><span class="p">)</span><span class="o">?</span><span class="p">[</span><span class="s1">&#39;DateNeeded&#39;</span><span class="p">],</span> <span class="s1">&#39;MM/dd/yyyy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we search and select <em>SharePoint - Create Item</em> once again, this time we choose Order Items list and start filling in all the columns.
Once we add any column from our DataTable, the action will automatically be transformed to run as many times as there are records in the DataTable:</p>
<img alt="Create Order Items" src="../_images/5_Create_Order_Items.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Everything else is fairly straightforward, when filling in Order lookup column, we need to select to add custom value and fill in the ID from our previous Item created.</p>
<p>That’s pretty much it, now we can click <strong>Save Flow</strong> and run some tests.</p>
</div>
<div class="section" id="result">
<h2><a class="toc-backref" href="#id5">Result</a><a class="headerlink" href="#result" title="Permalink to this headline">¶</a></h2>
<p>So, here’s my form in the browser, filled in with the test data:</p>
<img alt="Form in a browser" src="../_images/6_Form_Test.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>I press submit, then the Flow processes the request. There are no errors, so everything went smoothly.</p>
<p>Here’s an item created in SharePoint Order List:</p>
<img alt="Order List result" src="../_images/7_Result_Order.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>And here are all the items added to the Order Items List, all tied to the Order itself with a Lookup:</p>
<img alt="Ordered Items List result" src="../_images/8_Result_Items.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>


                    </div>
                    <div class="clearfix" style="padding-bottom: 50px;"></div>
                </div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="excel-datatable.html" title="Use table to add rows to Excel (Office365) or Google Sheet from Public Web Form"
             >next</a> |</li>
        <li class="right" >
          <a href="data-table-convert-html.html" title="Format Data Table in an HTML-template before converting into PDF"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Forms 1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="data-table-section.html" >Data Tables and MS Flow</a> &#187;</li> 
      </ul>
    </div>
    <script type="text/javascript">
      $("#mobile-toggle a").click(function () {
        $("#left-column").toggle();
      });
    </script>
    <script type="text/javascript" src="../_static/js/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/js/main.min.js"></script>
        <footer class="footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <nav class="footer__menu">
          <ul id="menu-footer-menu" class="menu"><li class=""><a href="#products">Products</a></li>
            <li class=""><a target="_blank" href="https://community.plumsail.com">Community</a></li>
            <li class=""><a href="/store/">Store</a></li>
            <li class=""><a target="_blank" href="https://medium.com/plumsail">Blog</a></li>
            <li class=""><a href="/partners-and-resellers/">Partners</a></li>
            <li class=""><a href="/company/">Company</a></li>
          </ul>
        </nav>
        <div class="footer__copyright">
          © 2011 - 2018 Plumsail. All rights reserved | <a href="/privacy-policy/">Privacy Policy</a> | <a href="/refund-policy/">Refund policy</a>
        </div>
      </div>
    </div>
  </div>
</footer>
            <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36215023-2']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>